# Story 1.1: Project Initialization & Supabase Integration

## Status

Approved

## Story

**As a** developer,
**I want** to initialize the Next.js project with Supabase integration,
**so that** the foundation is in place for building the application.

## Acceptance Criteria

1. Next.js 14 project created with TypeScript and Tailwind CSS 4.0 configured
2. Supabase project created with development and production environments
3. Supabase client initialized for browser and server contexts
4. Environment variables configured (.env.local with NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY)
5. Design System globals.css file integrated with theme variables and component styles
6. Font files (National2Condensed, ESKlarheit) added to public/fonts/ and loaded via @font-face
7. Project builds successfully and runs on localhost with no errors
8. Basic folder structure created (app/, components/, lib/, types/, styles/)

## Tasks / Subtasks

- [ ] Task 1: Initialize Next.js 14 project with TypeScript (AC: 1, 8)
  - [ ] Run `npx create-next-app@latest` with TypeScript, App Router, and Tailwind CSS options
  - [ ] Verify project structure includes app/, public/, and config files
  - [ ] Install additional dependencies: @supabase/supabase-js, date-fns, date-fns-tz
  - [ ] Configure tsconfig.json with path aliases (@/ for src)

- [ ] Task 2: Configure Tailwind CSS 4.0 and Design System (AC: 1, 5, 6)
  - [ ] Update tailwind.config.ts with custom theme colors, fonts, and spacing from design system
  - [ ] Create styles/globals.css with CSS variables and design tokens
  - [ ] Download and add National2Condensed and ESKlarheit font files to public/fonts/
  - [ ] Configure @font-face declarations in globals.css
  - [ ] Test font loading in browser dev tools

- [ ] Task 3: Create Supabase project and configure integration (AC: 2, 3, 4)
  - [ ] Create new Supabase project via dashboard (development environment)
  - [ ] Copy project URL and anon key from project settings
  - [ ] Create .env.local with NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY
  - [ ] Add .env.local to .gitignore
  - [ ] Create src/lib/supabase/client.ts for browser client
  - [ ] Create src/lib/supabase/server.ts for server-side client
  - [ ] Test connection by querying Supabase in a test API route

- [ ] Task 4: Set up core folder structure and shared types (AC: 8)
  - [ ] Create folder structure: src/components/, src/lib/, src/types/, src/app/
  - [ ] Create src/types/database.ts placeholder for future DB types
  - [ ] Create src/lib/config.ts for centralized config/env access
  - [ ] Create src/components/ui/ folder for shared UI components

- [ ] Task 5: Verify build and development environment (AC: 7)
  - [ ] Run `npm run dev` and verify localhost starts without errors
  - [ ] Run `npm run build` and verify successful production build
  - [ ] Check for TypeScript errors with `npm run type-check` (add script if needed)
  - [ ] Verify Tailwind CSS is working by adding test classes to page.tsx

## Dev Notes

**Relevant Tech Stack:**
- **Framework**: Next.js 14.2+ with App Router, TypeScript 5.3+
- **Styling**: Tailwind CSS 4.0+
- **Backend**: Supabase (PostgreSQL 15+, Auth, Storage)
- **Dependencies**: @supabase/supabase-js 2.39+, date-fns 3.0+, date-fns-tz

**Project Structure (from architecture/unified-project-structure.md):**
```
src/
├── app/                      # Next.js App Router
│   ├── layout.tsx            # Root layout
│   ├── page.tsx              # Landing page
│   ├── globals.css           # Design System styles
│   ├── (auth)/               # Auth routes
│   └── (app)/                # App routes with sidebar
├── components/               # React components
│   └── ui/                   # Shared UI components
├── lib/
│   ├── supabase/
│   │   ├── client.ts         # Browser client
│   │   └── server.ts         # Server client
│   ├── config.ts             # Centralized config/env access
│   └── utils/
│       └── date.ts           # Timezone utilities
├── types/
│   ├── database.types.ts     # Auto-generated from Supabase
│   └── index.ts              # Shared types
public/
└── fonts/                    # National2Condensed, ESKlarheit
```

**Critical Coding Standards:**
- **Environment Variables**: Must access via `src/lib/config.ts`, never `process.env` directly (except Next.js config files)
- **Type Sharing**: Define all shared types in `src/types/`, never duplicate between frontend/backend
- **File Naming**: Components use PascalCase (e.g., `UserProfile.tsx`), utilities use camelCase

**Design System (from front-end-spec.md):**
- **Theme**: Dark theme focus with strategic bright blue (#00A1FE) for primary actions
- **Fonts**: National2Condensed (headings), ESKlarheit (body text) - load via @font-face from public/fonts/
- **Principles**: Data density with clarity, instant feedback, mobile-first interactions

**Key Implementation Notes:**
- Use Next.js App Router (not Pages Router)
- Create both browser (`client.ts`) and server (`server.ts`) Supabase clients for App Router compatibility
- Set up path aliases: `@/` points to `src/`
- Install testing dependencies (Jest, React Testing Library, Playwright) but test implementation comes in later stories

### Testing

**Test Location:**
- Unit tests: `tests/unit/`
- Integration tests: `tests/integration/`
- E2E tests: `tests/e2e/`

**Testing Frameworks:**
- **Unit/Integration**: Jest 29+ with React Testing Library 14+
- **E2E**: Playwright 1.40+
- **Supabase Mocking**: Use `jest.mock('@supabase/auth-helpers-nextjs')` for unit tests

**Testing Standards for Story 1.1:**
- **No tests required for this story** - This is infrastructure setup only
- Testing frameworks will be installed (Jest, React Testing Library, Playwright) but test implementation comes in later stories
- Add test configuration files:
  - `jest.config.js` - Configure Jest with TypeScript support and path aliases
  - `playwright.config.ts` - Configure Playwright for E2E tests
  - Create empty test directories: `tests/unit/`, `tests/integration/`, `tests/e2e/`

**Test Distribution Target (for future stories):**
- 70% Unit tests (fast, isolated)
- 20% Integration tests (API + database)
- 10% E2E tests (critical user journeys)

**Key Testing Patterns (reference for later):**
- Mock Supabase client in component tests using `jest.mock()`
- Use `@testing-library/react` for component testing with `render()`, `screen`, `fireEvent`, `waitFor()`
- E2E tests should log in via test user in `beforeEach()` hook
- Verify RLS policies in integration tests to ensure user isolation

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-30 | 1.0 | Initial story creation from Epic 1 | John (PM) |

## Dev Agent Record

#### Agent Model Used

_To be populated by dev agent during implementation_

#### Debug Log References

_To be populated by dev agent during implementation_

#### Completion Notes List

_To be populated by dev agent during implementation_

#### File List

_To be populated by dev agent during implementation_

## QA Results

_To be populated by QA agent after story completion_